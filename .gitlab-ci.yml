image: ubuntu:latest

stages:
  - deploy

deploy:
  stage: deploy
  only:
    - master
  script:
    - ssh $DEPLOY_USER@$DEPLOY_HOST "cd $DEPLOY_PATH && git reset --hard origin/master && git clean -fd && git pull origin master --rebase && npm install && npx prisma migrate deploy && npm run build && pm2 restart 'interview-ready-back' && pm2 save"
